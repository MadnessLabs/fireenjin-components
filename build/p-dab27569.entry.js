import{r as t,c as i,h as e}from"./p-f1147c95.js";async function n(t,i,e=500){return new Promise((async(o,s)=>{i&&"function"==typeof i||s("Callback function is required!");try{o(i())}catch(o){t>1?(await(r=e,new Promise((t=>setTimeout(t,r)))),n(t-1,i,2*e)):s(o)}var r}))}const o=class{constructor(e){t(this,e),this.fireenjinFetch=i(this,"fireenjinFetch",7),this.data={},this.template={},this.html=""}componentWillLoad(){var t;(null===(t=window)||void 0===t?void 0:t.Handlebars)||async function(){new Promise(((t,i)=>{const e=document.createElement("script");e.async=!0,e.src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js",e.addEventListener("load",t),e.addEventListener("error",(()=>i("Error loading script."))),e.addEventListener("abort",(()=>i("Script loading aborted."))),document.head.appendChild(e)}))}(),this.templateId&&this.fireenjinFetch.emit({endpoint:"findTemplate",params:{id:this.templateId}})}componentDidLoad(){n(10,this.renderTemplate.bind(this))}renderTemplate(){var t,i;this.html=window.Handlebars.compile((null===(t=this.template)||void 0===t?void 0:t.html)?null===(i=this.template)||void 0===i?void 0:i.html:"")(this.data?this.data:{})}onSuccess(t){var i,e,n;"findTemplate"===(null===(i=null==t?void 0:t.detail)||void 0===i?void 0:i.endpoint)&&(this.template=(null===(n=null===(e=null==t?void 0:t.detail)||void 0===e?void 0:e.data)||void 0===n?void 0:n.template)?t.detail.data.template:null)}onTemplateId(){this.fireenjinFetch.emit({endpoint:"findTemplate",params:{id:this.templateId}})}onTemplate(){n(10,this.renderTemplate.bind(this))}render(){return e("div",{innerHTML:this.html})}static get watchers(){return{templateId:["onTemplateId"],template:["onTemplate"]}}};export{o as fireenjin_render_template}
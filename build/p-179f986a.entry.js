import{r as i,c as t,w as n,a as s,h as e,d as r,H as o,f as l}from"./p-e3de215b.js";import{g as a,c as h}from"./p-437e6017.js";import{s as d}from"./p-111520a0.js";const c=class{constructor(n){i(this,n),this.ionInfinite=t(this,"ionInfinite",7),this.thrPx=0,this.thrPc=0,this.didFire=!1,this.isBusy=!1,this.isLoading=!1,this.threshold="15%",this.disabled=!1,this.position="bottom",this.onScroll=()=>{const i=this.scrollEl;if(!i||!this.canStart())return 1;const t=this.el.offsetHeight;if(0===t)return 2;const n=i.scrollTop,s=i.offsetHeight,e=0!==this.thrPc?s*this.thrPc:this.thrPx;if(("bottom"===this.position?i.scrollHeight-t-n-e-s:n-t-e)<0){if(!this.didFire)return this.isLoading=!0,this.didFire=!0,this.ionInfinite.emit(),3}else this.didFire=!1;return 4}}thresholdChanged(){const i=this.threshold;i.lastIndexOf("%")>-1?(this.thrPx=0,this.thrPc=parseFloat(i)/100):(this.thrPx=parseFloat(i),this.thrPc=0)}disabledChanged(){const i=this.disabled;i&&(this.isLoading=!1,this.isBusy=!1),this.enableScrollEvents(!i)}async connectedCallback(){const i=this.el.closest("ion-content");i?(this.scrollEl=await i.getScrollElement(),this.thresholdChanged(),this.disabledChanged(),"top"===this.position&&n((()=>{this.scrollEl&&(this.scrollEl.scrollTop=this.scrollEl.scrollHeight-this.scrollEl.clientHeight)}))):console.error("<ion-infinite-scroll> must be used inside an <ion-content>")}disconnectedCallback(){this.enableScrollEvents(!1),this.scrollEl=void 0}async complete(){const i=this.scrollEl;if(this.isLoading&&i&&(this.isLoading=!1,"top"===this.position)){this.isBusy=!0;const t=i.scrollHeight-i.scrollTop;requestAnimationFrame((()=>{s((()=>{const s=i.scrollHeight-t;requestAnimationFrame((()=>{n((()=>{i.scrollTop=s,this.isBusy=!1}))}))}))}))}}canStart(){return!(this.disabled||this.isBusy||!this.scrollEl||this.isLoading)}enableScrollEvents(i){this.scrollEl&&(i?this.scrollEl.addEventListener("scroll",this.onScroll):this.scrollEl.removeEventListener("scroll",this.onScroll))}render(){const i=a(this);return e(o,{class:{[i]:!0,"infinite-scroll-loading":this.isLoading,"infinite-scroll-enabled":!this.disabled}})}get el(){return r(this)}static get watchers(){return{threshold:["thresholdChanged"],disabled:["disabledChanged"]}}};c.style="ion-infinite-scroll{display:none;width:100%}.infinite-scroll-enabled{display:block}";const m=class{constructor(t){i(this,t)}componentDidLoad(){if(void 0===this.loadingSpinner){const i=a(this);this.loadingSpinner=h.get("infiniteLoadingSpinner",h.get("spinner","ios"===i?"lines":"crescent"))}}render(){const i=a(this);return e(o,{class:{[i]:!0,["infinite-scroll-content-"+i]:!0}},e("div",{class:"infinite-loading"},this.loadingSpinner&&e("div",{class:"infinite-loading-spinner"},e("ion-spinner",{name:this.loadingSpinner})),this.loadingText&&e("div",{class:"infinite-loading-text",innerHTML:d(this.loadingText)})))}};m.style={ios:"ion-infinite-scroll-content{display:flex;flex-direction:column;justify-content:center;min-height:84px;text-align:center;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}@supports (margin-inline-start: 0) or (-webkit-margin-start: 0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-ios .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-small-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}",md:"ion-infinite-scroll-content{display:flex;flex-direction:column;justify-content:center;min-height:84px;text-align:center;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}@supports (margin-inline-start: 0) or (-webkit-margin-start: 0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-md .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-small-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}"};const g=class{constructor(t){i(this,t),this.inset=!1}async closeSlidingItems(){const i=this.el.querySelector("ion-item-sliding");return!(!i||!i.closeOpened)&&i.closeOpened()}render(){const i=a(this),{lines:t,inset:n}=this;return e(o,{class:{[i]:!0,["list-"+i]:!0,"list-inset":n,["list-lines-"+t]:void 0!==t,[`list-${i}-lines-${t}`]:void 0!==t}})}get el(){return r(this)}};g.style={ios:"ion-list{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:block;contain:content;list-style-type:none}ion-list.list-inset{transform:translateZ(0);overflow:hidden}.list-ios{background:var(--ion-item-background, var(--ion-background-color, #fff))}.list-ios.list-inset{margin-left:16px;margin-right:16px;margin-top:16px;margin-bottom:16px;border-radius:4px}@supports (margin-inline-start: 0) or (-webkit-margin-start: 0){.list-ios.list-inset{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}.list-ios.list-inset ion-item{--border-width:0 0 1px 0;--inner-border-width:0}.list-ios.list-inset ion-item:last-child{--border-width:0;--inner-border-width:0}.list-ios.list-inset+ion-list.list-inset{margin-top:0}.list-ios-lines-none .item{--border-width:0;--inner-border-width:0}.list-ios-lines-full .item,.list-ios .item-lines-full{--border-width:0 0 0.55px 0}.list-ios-lines-full .item{--inner-border-width:0}.list-ios-lines-inset .item,.list-ios .item-lines-inset{--inner-border-width:0 0 0.55px 0}.list-ios .item-lines-inset{--border-width:0}.list-ios .item-lines-full{--inner-border-width:0}.list-ios .item-lines-none{--border-width:0;--inner-border-width:0}ion-card .list-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}",md:"ion-list{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:block;contain:content;list-style-type:none}ion-list.list-inset{transform:translateZ(0);overflow:hidden}.list-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:8px;padding-bottom:8px;background:var(--ion-item-background, var(--ion-background-color, #fff))}.list-md>.input:last-child::after{left:0}[dir=rtl] .list-md>.input:last-child::after,:host-context([dir=rtl]) .list-md>.input:last-child::after{left:unset;right:unset;right:0}.list-md.list-inset{margin-left:16px;margin-right:16px;margin-top:16px;margin-bottom:16px;border-radius:2px}@supports (margin-inline-start: 0) or (-webkit-margin-start: 0){.list-md.list-inset{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}.list-md.list-inset ion-item:first-child{--border-radius:2px 2px 0 0;--border-width:0 0 1px 0}.list-md.list-inset ion-item:last-child{--border-radius:0 0 2px, 2px;--border-width:0}.list-md.list-inset .item-interactive{--padding-start:0;--padding-end:0}.list-md.list-inset+ion-list.list-inset{margin-top:0}.list-md-lines-none .item{--border-width:0;--inner-border-width:0}.list-md-lines-full .item,.list-md .item-lines-full{--border-width:0 0 1px 0}.list-md-lines-full .item{--inner-border-width:0}.list-md-lines-inset .item,.list-md .item-lines-inset{--inner-border-width:0 0 1px 0}.list-md .item-lines-inset{--border-width:0}.list-md .item-lines-full{--inner-border-width:0}.list-md .item-lines-none{--border-width:0;--inner-border-width:0}ion-card .list-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}"};const p=(i,t)=>{const n=f(i,t);return n&&i.ownerDocument?i.ownerDocument.importNode(n.content,!0).children[0]:null},f=(i,t)=>{switch(t){case"item":return i.querySelector("template:not([name])");case"header":return i.querySelector("template[name=header]");case"footer":return i.querySelector("template[name=footer]")}},u=(i,t,n,s,e,r,o,l,a,h,d,c)=>{const m=[],g=c+d;for(let c=d;c<g;c++){const d=i[c];if(e){const t=e(d,c,i);null!=t&&m.push({i:h++,type:"header",value:t,index:c,height:n?n(t,c):o,reads:n?0:2,visible:!!n})}if(m.push({i:h++,type:"item",value:d,index:c,height:t?t(d,c):a,reads:t?0:2,visible:!!t}),r){const t=r(d,c,i);null!=t&&m.push({i:h++,type:"footer",value:t,index:c,height:s?s(t,c):l,reads:s?0:2,visible:!!s})}}return m},b=class{constructor(t){i(this,t),this.range={offset:0,length:0},this.viewportHeight=0,this.cells=[],this.virtualDom=[],this.isEnabled=!1,this.viewportOffset=0,this.currentScrollTop=0,this.indexDirty=0,this.lastItemLen=0,this.totalHeight=0,this.approxItemHeight=45,this.approxHeaderHeight=30,this.approxFooterHeight=30,this.onScroll=()=>{this.updateVirtualScroll()}}itemsChanged(){this.calcCells(),this.updateVirtualScroll()}async connectedCallback(){const i=this.el.closest("ion-content");i?(this.scrollEl=await i.getScrollElement(),this.contentEl=i,this.calcCells(),this.updateState()):console.error("<ion-virtual-scroll> must be used inside an <ion-content>")}componentDidUpdate(){this.updateState()}disconnectedCallback(){this.scrollEl=void 0}onResize(){this.calcCells(),this.updateVirtualScroll()}positionForItem(i){return Promise.resolve(((i,t,n)=>{const s=t.find((t=>"item"===t.type&&t.index===i));return s?n[s.i]:-1})(i,this.cells,this.getHeightIndex()))}async checkRange(i,t=-1){if(!this.items)return;const n=-1===t?this.items.length-i:t,s=((i,t)=>0===t?0:t===(i.length>0?i[i.length-1].index:0)+1?i.length:i.findIndex((i=>i.index===t)))(this.cells,i),e=u(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,s,i,n);this.cells=((i,t,n)=>{if(0===n&&t.length>=i.length)return t;for(let s=0;s<t.length;s++)i[s+n]=t[s];return i})(this.cells,e,s),this.lastItemLen=this.items.length,this.indexDirty=Math.max(i-1,0),this.scheduleUpdate()}async checkEnd(){this.items&&this.checkRange(this.lastItemLen)}updateVirtualScroll(){this.isEnabled&&this.scrollEl&&(this.timerUpdate&&(clearTimeout(this.timerUpdate),this.timerUpdate=void 0),s(this.readVS.bind(this)),n(this.writeVS.bind(this)))}readVS(){const{contentEl:i,scrollEl:t,el:n}=this;let s=0,e=n;for(;e&&e!==i;)s+=e.offsetTop,e=e.offsetParent;this.viewportOffset=s,t&&(this.viewportHeight=t.offsetHeight,this.currentScrollTop=t.scrollTop)}writeVS(){const i=this.indexDirty,t=(e=this.currentScrollTop-this.viewportOffset,r=this.viewportHeight,{top:Math.max(e-100,0),bottom:e+r+100}),n=this.getHeightIndex(),s=((i,t)=>{const n=t.top,s=t.bottom;let e=0;for(;e<i.length&&!(i[e]>n);e++);const r=Math.max(e-2-1,0);for(;e<i.length&&!(i[e]>=s);e++);return{offset:r,length:Math.min(e+2,i.length)-r}})(n,t);var e,r;((i,t,n)=>i<=n.offset+n.length||t.offset!==n.offset||t.length!==n.length)(i,this.range,s)&&(this.range=s,((i,t,n,s)=>{for(const t of i)t.change=0,t.d=!0;const e=[],r=s.offset+s.length;for(let o=s.offset;o<r;o++){const s=n[o],r=i.find((i=>i.d&&i.cell===s));if(r){const i=t[o];i!==r.top&&(r.top=i,r.change=1),r.d=!1}else e.push(s)}const o=i.filter((i=>i.d));for(const n of e){const s=o.find((i=>i.d&&i.cell.type===n.type)),e=n.i;s?(s.d=!1,s.change=2,s.cell=n,s.top=t[e]):i.push({d:!1,cell:n,visible:!0,change:2,top:t[e]})}i.filter((i=>i.d&&-9999!==i.top)).forEach((i=>{i.change=1,i.top=-9999}))})(this.virtualDom,n,this.cells,s),this.nodeRender?((i,t,n,s)=>{const e=Array.from(i.children).filter((i=>"TEMPLATE"!==i.tagName)),r=e.length;let o;for(let l=0;l<n.length;l++){const a=n[l],h=a.cell;if(2===a.change){if(l<r)o=e[l],t(o,h,l);else{const n=p(i,h.type);o=t(n,h,l)||n,o.classList.add("virtual-item"),i.appendChild(o)}o.$ionCell=h}else o=e[l];0!==a.change&&(o.style.transform=`translate3d(0,${a.top}px,0)`);const d=h.visible;a.visible!==d&&(d?o.classList.remove("virtual-loading"):o.classList.add("virtual-loading"),a.visible=d),h.reads>0&&(s(h,o),h.reads--)}})(this.el,this.nodeRender,this.virtualDom,this.updateCellHeight.bind(this)):this.domRender?this.domRender(this.virtualDom):this.renderItem&&l(this))}updateCellHeight(i,t){const n=()=>{if(t.$ionCell===i){const n=window.getComputedStyle(t),s=t.offsetHeight+parseFloat(n.getPropertyValue("margin-bottom"));this.setCellHeight(i,s)}};t&&t.componentOnReady?t.componentOnReady().then(n):n()}setCellHeight(i,t){const n=i.i;i===this.cells[n]&&(i.height===t&&!0===i.visible||(i.visible=!0,i.height=t,this.indexDirty=Math.min(this.indexDirty,n),this.scheduleUpdate()))}scheduleUpdate(){clearTimeout(this.timerUpdate),this.timerUpdate=setTimeout((()=>this.updateVirtualScroll()),100)}updateState(){const i=!(!this.scrollEl||!this.cells);i!==this.isEnabled&&(this.enableScrollEvents(i),i&&this.updateVirtualScroll())}calcCells(){this.items&&(this.lastItemLen=this.items.length,this.cells=u(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,0,0,this.lastItemLen),this.indexDirty=0)}getHeightIndex(){return this.indexDirty!==1/0&&this.calcHeightIndex(this.indexDirty),this.heightIndex}calcHeightIndex(i=0){this.heightIndex=((i,t)=>{if(!i)return new Uint32Array(t);if(i.length===t)return i;if(t>i.length){const n=new Uint32Array(t);return n.set(i),n}return i.subarray(0,t)})(this.heightIndex,this.cells.length),this.totalHeight=((i,t,n)=>{let s=i[n];for(let e=n;e<i.length;e++)i[e]=s,s+=t[e].height;return s})(this.heightIndex,this.cells,i),this.indexDirty=1/0}enableScrollEvents(i){this.rmEvent&&(this.rmEvent(),this.rmEvent=void 0);const t=this.scrollEl;t&&(this.isEnabled=i,t.addEventListener("scroll",this.onScroll),this.rmEvent=()=>{t.removeEventListener("scroll",this.onScroll)})}renderVirtualNode(i){const{type:t,value:n,index:s}=i.cell;switch(t){case"item":return this.renderItem(n,s);case"header":return this.renderHeader(n,s);case"footer":return this.renderFooter(n,s)}}render(){return e(o,{style:{height:this.totalHeight+"px"}},this.renderItem&&e(x,{dom:this.virtualDom},this.virtualDom.map((i=>this.renderVirtualNode(i)))))}get el(){return r(this)}static get watchers(){return{itemHeight:["itemsChanged"],headerHeight:["itemsChanged"],footerHeight:["itemsChanged"],items:["itemsChanged"]}}},x=({dom:i},t,n)=>n.map(t,((t,n)=>{const s=i[n],e=t.vattrs||{};let r=e.class||"";return r+="virtual-item ",s.visible||(r+="virtual-loading"),Object.assign(Object.assign({},t),{vattrs:Object.assign(Object.assign({},e),{class:r,style:Object.assign(Object.assign({},e.style),{transform:`translate3d(0,${s.top}px,0)`})})})}));b.style="ion-virtual-scroll{display:block;position:relative;width:100%;contain:strict;user-select:none}ion-virtual-scroll>.virtual-loading{opacity:0}ion-virtual-scroll>.virtual-item{position:absolute !important;top:0 !important;right:0 !important;left:0 !important;transition-duration:0ms;will-change:transform}";export{c as ion_infinite_scroll,m as ion_infinite_scroll_content,g as ion_list,b as ion_virtual_scroll}